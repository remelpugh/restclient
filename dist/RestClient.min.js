!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.RestClient=e()}}(function(){return function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var p=new Error("Cannot find module '"+o+"'");throw p.code="MODULE_NOT_FOUND",p}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t){var n=(e("./HttpMethod"),e("./Utilities")),r=e("./OptionsNotSuppliedException"),i=function(){function e(e){this.cache=window.localStorage;var t=e;if(_.isUndefined(e))throw new r;this.config=t.config,this.schema=t.schema||{},this.headers=t.headers||[],this.parseSchema()}return e.prototype.ajax=function(t,n,r){var i=this;"undefined"==typeof r&&(r={});var s,o,a=this.config.cacheData;a&&(s="RestClient_"+t),_.isEmpty(r.schemaDefinition)||(o=this.schema[r.schemaDefinition]),_.isUndefined(r.headers)&&(r.headers=[]);var u=function(e){var t=!_.isUndefined(o),n=JSON.parse(e);if(t&&("function"==typeof o.parse&&(n=o.parse(n)),"undefined"!=typeof o.sort&&_.isArray(n))){var r=o.sort;_.isArray(r)||(r=[r]),_.each(r,function(e){n.sort(function(t,n){var r="asc"===e.direction.toLowerCase()?1:-1,i=e.field.split("."),s=function(e,t){return e[t]};return _.each(i,function(e){t=s(t,e),n=s(n,e)}),n>t?-1*r:t>n?r:0})})}return n};return new Promise(function(o,p){var f;if(f=r.headers.concat(i.headers),r.headers=_.uniq(f,"name"),a)try{return void o(u(i.cache.getItem(s)))}catch(c){}e.ajax(t,n,r).then(function(e){try{i.config.cacheData&&1===n&&i.cache.setItem(s,e),o(u(e))}catch(t){p({errors:["Invalid JSON: "+t.message]})}}).error(function(e){p(e)})})},e.prototype.get=function(e,t){return"undefined"==typeof t&&(t={}),this.ajax(this.getUri(e),1,t)},e.prototype.post=function(e,t,n){"undefined"==typeof n&&(n={});var r;return r={data:JSON.stringify(t)},_.defaults(n,r),this.ajax(this.getUri(e),2,r)},e.prototype.put=function(e,t,n){"undefined"==typeof n&&(n={});var r;return r={data:JSON.stringify(t)},_.defaults(n,r),this.ajax(this.getUri(e),3,r)},e.prototype.remove=function(e,t,n){"undefined"==typeof n&&(n={});var r;return r={data:JSON.stringify(t)},_.defaults(n,r),this.ajax(this.getUri(e),0,n)},e.prototype.updateSchema=function(e){var t=this,n=_.keys(this.schema),r=_.keys(e),i=_.difference(n,r);_.each(i,function(e){delete t[e]}),this.schema=e,this.parseSchema()},e.ajax=function(t,r,i){"undefined"==typeof i&&(i={});var s;if(_.defaults(i,e.defaults.AjaxOptions),!_.isEmpty(i.data)&&1===r){var o=n.serialize(i.data);t=t+(t.indexOf("?")>=0?"":"?")+o}switch(r){case 0:s="DELETE";break;case 1:s="GET";break;case 2:s="POST";break;case 3:s="PUT"}return new Promise(function(n,o){var a,u=e.createXmlHttpRequest(s,t);if(_.isNull(u))return void o(new Error("Failed to create a connection to the server."));u.onerror=function(){a={errors:["Unable to send request to "+t]},o(a)},u.onload=function(){var e=u.status;switch(e){case 500:a={errors:["Unexpected error."]},o(a);break;case 404:a={errors:["Endpoint not found: "+t]},o(a);break;case 400:try{a=JSON.parse(u.responseText)}catch(r){a={errors:["Unexpected error."]}}o(a);break;default:(e>=200&&299>=e||304===e)&&n(u.response)}},_.isEmpty(i.contentType)||u.setRequestHeader("content-type",i.contentType);var p=i.headers;_.isEmpty(p)||_.each(p,function(e){u.setRequestHeader(e.name,e.value)}),u.send(1===r?null:i.data)})},e.createXmlHttpRequest=function(e,t){var n=new XMLHttpRequest;return _.has(n,"withCredentials")?n.open(e,t,!0):_.isUndefined(XDomainRequest)?n=null:(n=new XDomainRequest,n.open(e,t,!0)),n},e.get=function(t,n){return"undefined"==typeof n&&(n={}),e.ajax(t,1,n)},e.post=function(t,n){return"undefined"==typeof n&&(n={}),e.ajax(t,2,n)},e.put=function(t,n){return"undefined"==typeof n&&(n={}),e.ajax(t,3,n)},e.remove=function(t,n){return"undefined"==typeof n&&(n={}),e.ajax(t,0,n)},e.formatString=function(e){for(var t=[],n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];var r,i,s,o=e;for(i=t.length,r=0;i>r;r+=1){var a=t[r];s=new RegExp("\\{(\\s)?"+r+"(\\s)?\\}","gi"),o=o.replace(s,a)}return o},e.prototype.getUri=function(e){return _.isString(e)?0===e.indexOf("/")?this.config.baseApiUri+e:e:_.isObject(e)?this.config.baseApiUri+e.url:this.config.baseApiUri},e.prototype.parseSchema=function(){var e=this,t=this.schema;void 0!==t&&null!==t&&_.each(t,function(t,n){var r=t.args||[],i=t.method||1,s=[],o=e.getUri(t);if(0===r.length){var a;if(s.push('var url = "'+o+'";\n'),s.push("var options = {\n"),s.push('	"data": arguments[1],\n'),s.push('	"schemaDefinition": "'+n+'"\n'),s.push("};\n"),s.push("if (id) {\n"),s.push('	url += "/" + id;\n'),s.push("}\n"),a=s.slice(0),a.push("return this.ajax(url, "+i+", options);\n"),_.has(e,n)&&delete e[n],e[n]=new Function("id",a.join("")),t.autoGenerateCrud===!0){var u,p,f,c=n.charAt(0).toUpperCase()+n.substring(1),h="delete"+c,d="post"+c,l="put"+c;u=s.slice(0),p=s.slice(0),f=s.slice(0),u.push("return this.ajax(url, 0, options);\n"),p.push("return this.ajax(url, 2, options);\n"),f.push("return this.ajax(url, 3, options);\n"),_.has(e,h)&&delete e[h],_.has(e,d)&&delete e[d],_.has(e,l)&&delete e[l],e["delete"+c]=new Function("id",u.join("")),e["post"+c]=new Function("id, data",p.join("")),e["put"+c]=new Function("id, data",f.join(""))}}else{var g,v=[],y=o.match(/\{\d\}/g),m=y?y.length:0,x="",j=new RegExp("\\{\\d\\}");if(m<r.length)for(var w=0;m>w;w+=1)v.push(r.shift());if(_.each(r,function(e){x.length>0&&(x+=", "),x+=e}),g=v.length>0,s.push('var url = "'+o+'";\n'),s.push("var options = {\n"),r.length>0){var U=[];s.push('	"data": {\n'),_.each(r,function(e,t){var n=g?t+m:t,r=e;U.length>0&&U.push(",\n"),U.push('		"'+r+'": arguments['+n+"]")}),s.push(U.join("")),s.push("	\n},"),s.push("\n")}s.push('	"schemaDefinition": "'+n+'"'),s.push("\n};\n"),j.test(o)&&(s.push("var args = [url];\n"),s.push("var passedArgs = Array.prototype.slice.call(arguments);\n"),s.push("var filteredArgs = [];\n"),s.push("for (var i = 0; i < "+m+"; i += 1) {\n"),s.push("	filteredArgs.push(passedArgs.shift());\n"),s.push("}\n"),s.push("args = args.concat(filteredArgs);\n"),s.push("url = RestClient.formatString.apply(this, args);\n")),s.push("return this.ajax(url, "+i+", options);\n"),_.has(e,n)&&delete e[n],e[n]=new Function(x,s.join(""))}})},e.defaults={AjaxOptions:{contentType:"application/json"}},e}();t.exports=i},{"./HttpMethod":3,"./OptionsNotSuppliedException":4,"./Utilities":5}],2:[function(e,t){var n=function(){function e(e){this.message=e}return e.prototype.toString=function(){return this.message},e}();t.exports=n},{}],3:[function(e,t){var n;!function(e){e[e.Delete=0]="Delete",e[e.Get=1]="Get",e[e.Post=2]="Post",e[e.Put=3]="Put"}(n||(n={})),t.exports=n},{}],4:[function(e,t){var n=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},r=e("./Exception"),i=function(e){function t(){e.call(this,"Options must be supplied.")}return n(t,e),t}(r);t.exports=i},{"./Exception":2}],5:[function(e,t){var n;!function(e){e.serialize=function(e){if(!_.isObject(e))return e;if(_.isNull(e)||_.isUndefined(e))return"";var t=[];return _.each(e,function(e,n){_.isUndefined(e)||t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}),t.join("&")}}(n||(n={})),t.exports=n},{}]},{},[1])(1)});